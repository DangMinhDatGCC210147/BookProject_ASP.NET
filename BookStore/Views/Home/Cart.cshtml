@model BusinessObjects.DTO.BookCartDetail
@{
	ViewData["Title"] = "Cart";
}
@using Microsoft.AspNetCore.Identity
@inject SignInManager<BusinessObjects.AppUser> SignInManager
@inject UserManager<BusinessObjects.AppUser> UserManager
<!-- shopping-cart-area start -->
<div class="cart-main-area pt-95 pb-100">
	<div class="container">
		<div class="row">
			<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
				@*Check Cart Empty*@
				@if (Model.BookCarts.Count == 0)
				{
					<div id="cartEmpty">
						<img src="/img/cart/empty.gif"
						style=" display: block; margin-left: auto; margin-right: auto; width: 50%;"/>
						<p class="text-center"
						style=" display: block; margin-left: auto; margin-right: auto; ">
							Product Cart is empty
						</p>
					</div>
					<div class="pt-5">
						<h6 class="mb-3 back">
							@if (SignInManager.IsSignedIn(User))
							{
								var user = await UserManager.GetUserAsync(User);
								<a asp-controller="Home" asp-action="Shop" asp-route-userId="@user.Id" class="text-body fw-semibold">
									<i class="fas fa-long-arrow-alt-left ms-5 me-2"></i>
									Back to shop
								</a>
							}
						</h6>
					</div>
				}
				else
				{
					<h1 class="cart-heading">Cart</h1>
					<div class="table-content table-responsive" id="check_cart_empty">
						<table>
							<thead>
								<tr>
									<th>remove</th>
									<th>images</th>
									<th>Product</th>
									<th>Price</th>
									<th>Quantity</th>
									<th>Total</th>
								</tr>
							</thead>
							<tbody id="tbody_cart">
								@foreach (var item in Model.BookCarts)
								{
									<tr id="row_cart_@item.BookId">
										<td class="product-remove"><a onclick="DeleteCart(@item.BookId)"><i class="pe-7s-close"></i></a></td>
										<td class="product-thumbnail">
											<a asp-controller="Home" asp-action="Detail" asp-route-id="@item.BookId"><img src="/img/product/book/@item.Image" alt=""></a>
										</td>
										<td class="product-name"><a asp-controller="Home" asp-action="Detail" asp-route-id="@item.BookId" id="product-name_@item.BookId">@item.Title</a></td>
										<td class="product-price-cart"><span class="amount" id="price_@item.BookId">$@item.Price</span></td>
										<td class="product-quantity">
											<div class="input-quantity">
												<div class="input-group-append">
													<div class="cart-plus-minus">
														<div class="inc qtybutton" onclick="UpdateQuantity('minus_' + @item.BookId)">-</div>
													</div>
												</div>
												<span id="quantity_@item.BookId" class="form-control text-center input_quantity_box">@item.Quantity</span>
												<div class="input-group-append">
													<div class="cart-plus-minus">
														<div class="inc qtybutton" onclick="UpdateQuantity('plus_' + @item.BookId)">+</div>
													</div>
												</div>
											</div>
										</td>
										<td class="product-subtotal" id="unitTotal_@item.BookId">$@item.SubTotal</td>
									</tr>
								}
							</tbody>
						</table>
					</div>
					<div class="row">
						<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
							<div class="coupon-all">
								<div class="coupon">
									<input id="coupon_code" class="input-text" name="coupon_code" value="" placeholder="Coupon code" type="text">
									<button name="apply_coupon" onclick="ApplyDiscount()">Apply coupon</button>
								</div>
							</div>
						</div>
					</div>
					<div class="row">
						<div class="col-md-5 ms-auto">
							<div class="cart-page-total">
								<h2>Cart totals</h2>
								<form asp-controller="Home" asp-action="CheckOut" method="POST">
									<ul @Model.TotalCart>
										<li>Subtotal<input readonly asp-for="TotalCart.SubTotal" value="0.00" /></li>
										<li id="apply_discount" style="display: none">Apply Discount<input readonly asp-for="TotalCart.Discount" id="cart_discount" value="0.00" /></li>
										<li>Total<input readonly asp-for="TotalCart.Total" value="0.00" /></li>
									</ul>
									<input type="hidden" asp-for="TotalCart.DiscountId" value="0" />
									<button type="submit" name="button">Proceed to checkout</button>
								</form>
							</div>
						</div>
					</div>
				}
				@*End if*@
			</div>
		</div>
	</div>
</div>
@section Scripts {
	<script src="~/js/main.js"></script>
	<script src="~/js/header.js"></script>
	<script src="~/js/discount.js"></script>
	<script src="~/js/cartdetail.js"></script>
}